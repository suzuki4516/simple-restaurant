# 📝 Googleフォーム設定 - 完全ガイド（画像付き説明）

**所要時間：約10分**

このガイドでは、予約システムとGoogleフォームを連携させて、予約が入るたびに自動でメール通知が届くようにします。

---

## 📋 全体の流れ

1. ✅ Googleフォームを作成（5分）
2. ✅ フォームIDとentry IDを取得（3分）
3. ✅ コードに設定を反映（1分）
4. ✅ メール通知を設定（1分）

---

# ステップ1️⃣: Googleフォームを作成する

## 1-1. Googleフォームにアクセス

1. ブラウザで以下のURLを開く
   ```
   https://forms.google.com/
   ```

2. Googleアカウントでログイン（ログインしていない場合）

3. **画面の様子：**
   - 左上に「Google フォーム」のロゴ
   - 中央に「新しいフォームを作成」
   - 「空白」というカードが表示される

4. **「空白」をクリック**

---

## 1-2. フォームのタイトルを設定

新しいフォームが開きます。

1. **画面上部の「無題のフォーム」をクリック**
2. タイトルを入力：`レストラン味彩 予約フォーム`
3. 説明を入力（任意）：`オンライン予約システムからの予約データ`

**画面の様子：**
```
┌─────────────────────────────────────┐
│ レストラン味彩 予約フォーム           │
│ オンライン予約システムからの予約データ │
├─────────────────────────────────────┤
│ 無題の質問                           │
│ [ラジオボタン ▼]                     │
└─────────────────────────────────────┘
```

---

## 1-3. 質問を追加する（9つの質問）

### 📌 質問1: 予約日時

1. 「無題の質問」をクリック
2. 質問文を入力：`予約日時`
3. 右側のプルダウンが「記述式」になっていることを確認
   - もし違う場合は、プルダウンをクリックして「記述式」を選択
4. **右下の「必須」をオンにする（重要！）**
   - スイッチが青色になればOK

**画面の様子：**
```
┌─────────────────────────────────────┐
│ 予約日時                             │
│ ──────────────                      │ ← テキスト入力欄
│ 記述式 ▼                    [必須 ●] │
└─────────────────────────────────────┘
```

5. 下の「➕」ボタンをクリックして次の質問を追加

---

### 📌 質問2: 予約時間

1. 質問文：`予約時間`
2. タイプ：`記述式`
3. 必須：`オン`
4. 「➕」をクリック

---

### 📌 質問3: 人数

1. 質問文：`人数`
2. タイプ：`記述式`
3. 必須：`オン`
4. 「➕」をクリック

---

### 📌 質問4: コース

1. 質問文：`コース`
2. タイプ：`記述式`
3. 必須：`オン`
4. 「➕」をクリック

---

### 📌 質問5: お名前

1. 質問文：`お名前`
2. タイプ：`記述式`
3. 必須：`オン`
4. 「➕」をクリック

---

### 📌 質問6: フリガナ

1. 質問文：`フリガナ`
2. タイプ：`記述式`
3. 必須：`オン`
4. 「➕」をクリック

---

### 📌 質問7: メールアドレス

1. 質問文：`メールアドレス`
2. タイプ：`記述式`
3. 必須：`オン`
4. 「➕」をクリック

---

### 📌 質問8: 電話番号

1. 質問文：`電話番号`
2. タイプ：`記述式`
3. 必須：`オン`
4. 「➕」をクリック

---

### 📌 質問9: ご要望・アレルギー

1. 質問文：`ご要望・アレルギー`
2. **タイプ：`段落`（重要！他の質問と違います）**
   - 右側のプルダウンをクリック
   - 「段落」を選択
3. **必須：`オフ`（この質問だけオフ）**

**画面の様子：**
```
┌─────────────────────────────────────┐
│ ご要望・アレルギー                    │
│ ──────────────                      │
│ ──────────────                      │ ← 複数行入力欄
│ ──────────────                      │
│ 段落 ▼                      [必須 ○] │ ← 必須はオフ
└─────────────────────────────────────┘
```

---

## 1-4. 完成確認

すべての質問が追加できたら、画面を上から下まで確認してください。

**チェックリスト：**
- [ ] 質問が9個ある
- [ ] 質問1〜8は「記述式」、質問9だけ「段落」
- [ ] 質問1〜8は「必須」がオン、質問9だけオフ
- [ ] 質問の順番が正しい

---

# ステップ2️⃣: フォームIDを取得する

## 2-1. URLからフォームIDをコピー

1. **画面上部のURLバーを見る**

2. URLの形式：
   ```
   https://docs.google.com/forms/d/【ここがフォームID】/edit
   ```

3. 例：
   ```
   https://docs.google.com/forms/d/1cAvRmsZqw0zffZZOAe7OU1-STeaaDTqiwDjE0WYq9R4/edit
                                  ↑─────────────────────────────────────↑
                                         この部分がフォームID
   ```

4. **フォームIDをコピーしてメモ帳などに保存**

---

# ステップ3️⃣: entry IDを取得する

## 3-1. プレビュー画面を開く

1. **画面右上の「👁」（目のアイコン）をクリック**
   - ボタンの位置：送信ボタンの左隣

2. 新しいタブでプレビューが開きます

**プレビュー画面の様子：**
```
┌─────────────────────────────────────┐
│ レストラン味彩 予約フォーム           │
│ オンライン予約システムからの予約データ │
├─────────────────────────────────────┤
│ 予約日時 *                           │
│ [____________]                      │
│                                     │
│ 予約時間 *                           │
│ [____________]                      │
│ ...                                 │
└─────────────────────────────────────┘
```

---

## 3-2. 開発者ツールを開く

### Windows の場合：

1. **キーボードの「F12」を押す**

または

1. ページ上で右クリック
2. 「検証」をクリック

### Mac の場合：

1. **「Command + Option + I」を押す**

または

1. ページ上で右クリック
2. 「検証」をクリック

---

## 3-3. 開発者ツールが開いた様子

画面の右側または下側に、以下のようなパネルが開きます：

```
┌─────────────────────────────────────┐
│ Elements Console Sources ... ×      │ ← タブが並んでいる
├─────────────────────────────────────┤
│ <html lang="ja">                    │
│   <head>                            │
│     <meta charset="utf-8">          │
│   </head>                           │
│   <body>                            │
│     <div class="...">               │
│       <input type="text" name="..." │ ← HTMLコード
│     </div>                          │
│   </body>                           │
└─────────────────────────────────────┘
```

**「Elements」タブになっていることを確認してください**

---

## 3-4. entry IDを取得する（重要！）

### 質問1（予約日時）のentry IDを取得：

1. **プレビュー画面で「予約日時」の入力欄を右クリック**

2. **「検証」をクリック**

3. 開発者ツールに `<input>` タグがハイライト（青色に光る）される

4. その行に以下のようなコードがあります：
   ```html
   <input type="text" name="entry.123456789" ...>
                           ↑──────────────↑
                              これがentry ID
   ```

5. **`entry.` の後ろの数字をメモする**
   - 例：`entry.123456789` なら `entry.123456789` 全体をメモ

---

### 同じ手順を9つの質問すべてに繰り返す：

**質問2（予約時間）のentry IDを取得：**
1. 「予約時間」の入力欄を右クリック → 検証
2. `name="entry.XXXXXXXXX"` の部分を見つける
3. メモする

**質問3〜8も同様に繰り返す**

**質問9（ご要望・アレルギー）のentry IDを取得：**
- ⚠️ この質問は `<textarea>` タグです（`<input>` ではない）
- でも同じように `name="entry.XXXXXXXXX"` があります
- 同じ手順でentry IDを取得してください

---

### メモ用テンプレート

以下のテンプレートに記入してください：

```
質問1 - 予約日時: entry._________________
質問2 - 予約時間: entry._________________
質問3 - 人数: entry._________________
質問4 - コース: entry._________________
質問5 - お名前: entry._________________
質問6 - フリガナ: entry._________________
質問7 - メールアドレス: entry._________________
質問8 - 電話番号: entry._________________
質問9 - ご要望・アレルギー: entry._________________
```

---

## 💡 entry IDを簡単に見つけるコツ

### 方法1: 検索機能を使う

1. 開発者ツールで `Ctrl + F`（Mac: `Command + F`）を押す
2. 検索ボックスに `entry.` と入力
3. 該当箇所がハイライトされる
4. 矢印ボタンで次々と探せる

### 方法2: 自動取得スクリプトを使う

**もっと簡単な方法があります！**

以下のファイルを参照してください：
- [GET_ENTRY_IDS.md](GET_ENTRY_IDS.md)

コンソールにスクリプトをコピペするだけで、すべてのentry IDが自動で取得できます！

---

# ステップ4️⃣: コードに設定を反映する

## 4-1. VSCodeでファイルを開く

1. VSCodeで以下のファイルを開く：
   ```
   simple-restaurant/js/reservation.js
   ```

2. ファイルの最初の方（5〜21行目あたり）に以下のコードがあります：

```javascript
const GOOGLE_FORM_CONFIG = {
    formId: '',
    entries: {
        date: 'entry.000000001',
        time: 'entry.000000002',
        guests: 'entry.000000003',
        course: 'entry.000000004',
        name: 'entry.000000005',
        nameKana: 'entry.000000006',
        email: 'entry.000000007',
        phone: 'entry.000000008',
        requests: 'entry.000000009'
    }
};
```

---

## 4-2. フォームIDを入力

1. `formId: ''` の `''` の中に、ステップ2で取得したフォームIDを貼り付け

**編集前：**
```javascript
formId: '',
```

**編集後（例）：**
```javascript
formId: '1cAvRmsZqw0zffZZOAe7OU1-STeaaDTqiwDjE0WYq9R4',
```

---

## 4-3. entry IDを入力

1. ステップ3で取得した9つのentry IDを、それぞれ対応する場所に貼り付け

**編集前：**
```javascript
entries: {
    date: 'entry.000000001',
    time: 'entry.000000002',
    ...
}
```

**編集後（例）：**
```javascript
entries: {
    date: 'entry.123456789',      // ← 実際に取得したentry IDに置き換え
    time: 'entry.234567890',      // ← 実際に取得したentry IDに置き換え
    guests: 'entry.345678901',    // ← 実際に取得したentry IDに置き換え
    course: 'entry.456789012',    // ← 実際に取得したentry IDに置き換え
    name: 'entry.567890123',      // ← 実際に取得したentry IDに置き換え
    nameKana: 'entry.678901234',  // ← 実際に取得したentry IDに置き換え
    email: 'entry.789012345',     // ← 実際に取得したentry IDに置き換え
    phone: 'entry.890123456',     // ← 実際に取得したentry IDに置き換え
    requests: 'entry.901234567'   // ← 実際に取得したentry IDに置き換え
}
```

---

## 4-4. 保存する

1. **`Ctrl + S`（Mac: `Command + S`）で保存**

2. 保存されたら設定完了！

---

# ステップ5️⃣: スプレッドシートとメール通知を設定

## 5-1. スプレッドシートを作成

1. **Googleフォームの編集画面に戻る**
   - ブラウザのタブを切り替え

2. **「回答」タブをクリック**
   - 画面上部に「質問」「回答」「設定」と並んでいます

**画面の様子：**
```
┌─────────────────────────────────────┐
│ 質問 | 回答 | 設定                   │ ← ここの「回答」をクリック
├─────────────────────────────────────┤
│ まだ回答がありません                 │
│                                     │
│ [📊 スプレッドシートアイコン]        │ ← 緑色のアイコン
└─────────────────────────────────────┘
```

3. **右上の緑色のスプレッドシートアイコンをクリック**
   - アイコンの形：四角いグリッド状

4. ダイアログが開きます

**ダイアログの様子：**
```
┌─────────────────────────────────────┐
│ 回答先を選択                         │
│                                     │
│ ○ 新しいスプレッドシートを作成       │
│ ○ 既存のスプレッドシートを選択       │
│                                     │
│ [キャンセル] [作成]                 │
└─────────────────────────────────────┘
```

5. **「新しいスプレッドシートを作成」が選択されていることを確認**

6. **「作成」ボタンをクリック**

7. 新しいタブでGoogleスプレッドシートが開きます

---

## 5-2. スプレッドシートの確認

開いたスプレッドシートには、以下のような列が自動で作成されています：

```
┌────────────┬──────┬──────┬────┬───────┬────────┬─────────┬──────────┬──────────┬──────────────┐
│ タイムスタンプ│ 予約日時│ 予約時間│ 人数 │ コース │ お名前  │ フリガナ │ メールアドレス│ 電話番号  │ ご要望・アレルギー│
├────────────┼──────┼──────┼────┼───────┼────────┼─────────┼──────────┼──────────┼──────────────┤
│            │      │      │    │       │        │         │          │          │              │
└────────────┴──────┴──────┴────┴───────┴────────┴─────────┴──────────┴──────────┴──────────────┘
```

これで予約データが自動的にこのスプレッドシートに記録されます！

---

## 5-3. メール通知を設定

### 通知ルールを作成：

1. **スプレッドシートのメニューから「ツール」をクリック**

**メニューの様子：**
```
┌─────────────────────────────────────┐
│ ファイル 編集 表示 挿入 表示形式    │
│ データ ツール 拡張機能 ヘルプ       │ ← 「ツール」をクリック
└─────────────────────────────────────┘
      ↓
┌─────────────────────────┐
│ スペルチェック           │
│ ────────────────────     │
│ 通知ルール...           │ ← これをクリック
│ マクロ                  │
│ ...                     │
└─────────────────────────┘
```

2. **「通知ルール」をクリック**

3. ダイアログが開きます

---

### 通知設定：

**ダイアログの様子：**
```
┌─────────────────────────────────────┐
│ 通知ルール                           │
│                                     │
│ 次の場合に通知する:                 │
│ [ユーザーがフォームを送信したとき ▼] │ ← これを選択
│                                     │
│ 通知方法:                           │
│ [メール - 毎日 ▼]                   │
│   ↓                                │
│ [メール - すぐに通知する ▼]         │ ← これを選択
│                                     │
│ [キャンセル] [保存] [完了]          │
└─────────────────────────────────────┘
```

4. **「次の場合に通知する」のプルダウンをクリック**
   - 「ユーザーがフォームを送信したとき」を選択

5. **「通知方法」のプルダウンをクリック**
   - 「メール - すぐに通知する」を選択

6. **「保存」ボタンをクリック**

7. 確認ダイアログが出たら「完了」をクリック

---

## 5-4. 設定完了！

これで以下のようになります：

✅ **予約が入ると...**
1. Googleフォームにデータが送信される
2. スプレッドシートに自動で記録される
3. **設定したメールアドレスに即座に通知が届く**

**メール通知の内容（例）：**
```
件名: スプレッドシート「レストラン味彩 予約フォーム（回答）」に変更がありました

本文:
レストラン味彩 予約フォーム（回答）に新しい行が追加されました。

スプレッドシートを開く >
```

---

# ステップ6️⃣: テストする

## 6-1. 予約システムで予約を入れる

1. **ブラウザで `reservation.html` を開く**

2. **テスト予約を入れる：**
   - 日付を選択
   - 時間帯を選択（例：ランチ 12:00）
   - 人数を選択（例：2名）
   - コースを選択（例：日替わりランチ）
   - お客様情報を入力（テスト用の情報でOK）
   - 予約を確定

---

## 6-2. 結果を確認

### ✅ チェック1: 予約完了画面が表示される

予約番号が表示されればOK

```
┌─────────────────────────────────────┐
│          ✓                          │
│ ご予約ありがとうございます           │
│                                     │
│ 予約番号                            │
│ R12345678                           │ ← 表示される
└─────────────────────────────────────┘
```

---

### ✅ チェック2: スプレッドシートに記録される

1. Googleスプレッドシートのタブを開く

2. 最新の行に予約データが追加されているか確認

```
┌────────────┬──────────┬──────┬────┐
│ タイムスタンプ│ 予約日時  │ 予約時間│ 人数│
├────────────┼──────────┼──────┼────┤
│ 2024/xx/xx │ 2024年12月│ 12:00│ 2名│ ← 追加される
│ 14:30:00   │ 15日（日）│      │    │
└────────────┴──────────┴──────┴────┘
```

---

### ✅ チェック3: メールが届く

1. **設定したメールアドレスの受信箱を確認**

2. Googleスプレッドシートからメールが届いているか確認
   - 件名：「スプレッドシート...に変更がありました」
   - 送信元：`sheets-noreply@google.com`

3. **メールが届いていればテスト成功！**

---

## ❌ メールが届かない場合

### 確認事項：

1. **迷惑メールフォルダを確認**
   - Googleからのメールが迷惑メールに入っている可能性

2. **通知設定を確認**
   - スプレッドシートの「ツール」→「通知ルール」
   - 「すぐに通知する」になっているか

3. **Googleアカウントの通知設定を確認**
   - https://myaccount.google.com/notifications
   - Googleスプレッドシートの通知が有効か

---

# 🎉 完了！

お疲れ様でした！これで予約システムとGoogleフォームの連携が完了しました。

## できるようになったこと

✅ 予約が入るたびにメールで通知
✅ スプレッドシートで予約を一覧管理
✅ 完全無料で運用可能
✅ 24時間自動受付

---

# 📞 トラブルシューティング

## Q1. entry IDが見つからない

**A:** 以下を確認してください：
- フォームのプレビュー画面で実行していますか？
- 開発者ツールの「Elements」タブになっていますか？
- `Ctrl + F` で `entry.` を検索してみてください

---

## Q2. 予約が送信されない

**A:** ブラウザのコンソールでエラーを確認：
1. F12で開発者ツールを開く
2. 「Console」タブをクリック
3. エラーメッセージが表示されていないか確認

よくあるエラー：
- `formId is empty` → フォームIDが設定されていない
- `entry.XXX not found` → entry IDが間違っている

---

## Q3. スプレッドシートにデータが入らない

**A:** 以下を確認：
1. formIdが正しいか
2. entry IDがすべて正しいか
3. ブラウザのコンソールにエラーが出ていないか

---

## Q4. もっと簡単な方法はないの？

**A:** あります！

[GET_ENTRY_IDS.md](GET_ENTRY_IDS.md) を参照してください。

自動取得スクリプトを使えば、entry IDを手動で探す必要がありません。

---

## 🆘 サポートが必要な場合

それでもうまくいかない場合は、以下を教えてください：
- どのステップでつまずいているか
- エラーメッセージ（あれば）
- ブラウザのコンソールに表示されている内容

---

**作成日**: 2024年
**最終更新**: 2024年

このガイドが役に立ったら、ぜひ他のプロジェクトでも活用してください！
