<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Googleãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px 10px 0;
        }
        button:hover {
            background: #45a049;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
            display: none;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        .step {
            margin: 10px 0;
            padding: 10px;
            background: #fff;
            border-left: 3px solid #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Googleãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ãƒ‡ãƒãƒƒã‚°ãƒ†ã‚¹ãƒˆ</h1>

        <div class="info-box">
            <strong>ã“ã®ãƒšãƒ¼ã‚¸ã®ç›®çš„ï¼š</strong><br>
            äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰Googleãƒ•ã‚©ãƒ¼ãƒ ã¸ã®é€ä¿¡ãŒæ­£ã—ãå‹•ä½œã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚
        </div>

        <div class="step">
            <h3>ã‚¹ãƒ†ãƒƒãƒ—1: è¨­å®šç¢ºèª</h3>
            <p>ç¾åœ¨ã®è¨­å®š:</p>
            <div id="config"></div>
        </div>

        <div class="step">
            <h3>ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ†ã‚¹ãƒˆé€ä¿¡</h3>
            <p>ä»¥ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã¾ã™ã€‚</p>
            <button id="testBtn" onclick="sendTestData()">ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡</button>
            <button onclick="clearLog()">ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢</button>
        </div>

        <div class="step">
            <h3>ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ­ã‚°</h3>
            <div class="log" id="log"></div>
        </div>

        <div id="result"></div>

        <div class="step">
            <h3>æ¬¡ã«ã™ã‚‹ã“ã¨</h3>
            <ol>
                <li>ã€Œãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li>ãƒ­ã‚°ã‚’ç¢ºèªï¼ˆã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Œã°èµ¤å­—ã§è¡¨ç¤ºã•ã‚Œã¾ã™ï¼‰</li>
                <li><strong>Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’é–‹ã„ã¦</strong>ã€æ–°ã—ã„è¡ŒãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª</li>
                <li>ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ã‚’ç¢ºèª</li>
            </ol>
        </div>
    </div>

    <script>
        // reservation.jsã¨åŒã˜è¨­å®š
        const GOOGLE_FORM_CONFIG = {
            formId: '1FAIpQLSeR_8t8vea0cEzUG1uztwAq0y2VMzbiptSN2ryE4qGOnMC4mA',
            entries: {
                date: 'entry.1854835807',
                time: 'entry.508842742',
                guests: 'entry.1436268677',
                course: 'entry.465794597',
                name: 'entry.1387828492',
                nameKana: 'entry.669712672',
                email: 'entry.358414579',
                phone: 'entry.1791113540',
                requests: 'entry.578940633'
            }
        };

        // ãƒ­ã‚°å‡ºåŠ›
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? 'red' : type === 'success' ? 'green' : 'black';
            logDiv.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(message);
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
            document.getElementById('result').style.display = 'none';
        }

        // è¨­å®šè¡¨ç¤º
        window.onload = function() {
            const configDiv = document.getElementById('config');
            const formUrl = `https://docs.google.com/forms/d/e/${GOOGLE_FORM_CONFIG.formId}/formResponse`;

            configDiv.innerHTML = `
                <p><strong>ãƒ•ã‚©ãƒ¼ãƒ ID:</strong> ${GOOGLE_FORM_CONFIG.formId}</p>
                <p><strong>é€ä¿¡å…ˆURL:</strong> <br><small>${formUrl}</small></p>
                <p><strong>Entry IDs:</strong></p>
                <ul style="font-size: 12px; margin: 5px 0;">
                    <li>date: ${GOOGLE_FORM_CONFIG.entries.date}</li>
                    <li>time: ${GOOGLE_FORM_CONFIG.entries.time}</li>
                    <li>guests: ${GOOGLE_FORM_CONFIG.entries.guests}</li>
                    <li>course: ${GOOGLE_FORM_CONFIG.entries.course}</li>
                    <li>name: ${GOOGLE_FORM_CONFIG.entries.name}</li>
                    <li>nameKana: ${GOOGLE_FORM_CONFIG.entries.nameKana}</li>
                    <li>email: ${GOOGLE_FORM_CONFIG.entries.email}</li>
                    <li>phone: ${GOOGLE_FORM_CONFIG.entries.phone}</li>
                    <li>requests: ${GOOGLE_FORM_CONFIG.entries.requests}</li>
                </ul>
            `;

            log('ãƒ‡ãƒãƒƒã‚°ãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ', 'success');
            log('è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„');
        };

        async function sendTestData() {
            const btn = document.getElementById('testBtn');
            btn.disabled = true;
            btn.textContent = 'é€ä¿¡ä¸­...';
            clearLog();

            log('=== ãƒ†ã‚¹ãƒˆé€ä¿¡ã‚’é–‹å§‹ã—ã¾ã™ ===', 'info');

            try {
                // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
                const testData = {
                    date: new Date(),
                    time: '12:00',
                    guests: '2',
                    course: 'ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ã‚¹',
                    name: 'ãƒ†ã‚¹ãƒˆ å¤ªéƒ',
                    nameKana: 'ãƒ†ã‚¹ãƒˆ ã‚¿ãƒ­ã‚¦',
                    email: 'test@example.com',
                    phone: '090-1234-5678',
                    requests: 'ãƒ‡ãƒãƒƒã‚°ãƒ†ã‚¹ãƒˆé€ä¿¡'
                };

                log('ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿: ' + JSON.stringify(testData, null, 2));

                // ãƒ•ã‚©ãƒ¼ãƒ URLæ§‹ç¯‰
                const formUrl = `https://docs.google.com/forms/d/e/${GOOGLE_FORM_CONFIG.formId}/formResponse`;
                log('é€ä¿¡å…ˆURL: ' + formUrl);

                // æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
                const date = new Date(testData.date);
                const dateStr = `${date.getFullYear()}å¹´${date.getMonth() + 1}æœˆ${date.getDate()}æ—¥ï¼ˆ${['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'][date.getDay()]}ï¼‰`;
                log('ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¸ˆã¿æ—¥ä»˜: ' + dateStr);

                // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ä½œæˆ
                const formData = new FormData();
                formData.append(GOOGLE_FORM_CONFIG.entries.date, dateStr);
                formData.append(GOOGLE_FORM_CONFIG.entries.time, testData.time);
                formData.append(GOOGLE_FORM_CONFIG.entries.guests, testData.guests + 'å');
                formData.append(GOOGLE_FORM_CONFIG.entries.course, testData.course);
                formData.append(GOOGLE_FORM_CONFIG.entries.name, testData.name);
                formData.append(GOOGLE_FORM_CONFIG.entries.nameKana, testData.nameKana);
                formData.append(GOOGLE_FORM_CONFIG.entries.email, testData.email);
                formData.append(GOOGLE_FORM_CONFIG.entries.phone, testData.phone);
                formData.append(GOOGLE_FORM_CONFIG.entries.requests, testData.requests);

                log('FormDataã‚’ä½œæˆã—ã¾ã—ãŸ');

                // é€ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ã‚°å‡ºåŠ›
                log('=== é€ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ ===');
                for (let [key, value] of formData.entries()) {
                    log(`  ${key} = ${value}`);
                }

                log('Googleãƒ•ã‚©ãƒ¼ãƒ ã¸é€ä¿¡ä¸­...');

                // é€ä¿¡
                const response = await fetch(formUrl, {
                    method: 'POST',
                    body: formData,
                    mode: 'no-cors'
                });

                log('fetchå®Œäº† (no-corsãƒ¢ãƒ¼ãƒ‰ã®ãŸã‚è©³ç´°ã¯ä¸æ˜)', 'info');
                log('=== é€ä¿¡å®Œäº† ===', 'success');

                // çµæœè¡¨ç¤º
                const resultDiv = document.getElementById('result');
                resultDiv.className = 'success';
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <h3>âœ… é€ä¿¡ãŒå®Œäº†ã—ã¾ã—ãŸ</h3>
                    <p><strong>æ¬¡ã®ç¢ºèªäº‹é …ï¼š</strong></p>
                    <ol>
                        <li><strong>Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’é–‹ã</strong><br>
                            <a href="https://docs.google.com/spreadsheets" target="_blank" style="color: #2196F3;">https://docs.google.com/spreadsheets</a><br>
                            æœ€æ–°ã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«æ–°ã—ã„è¡ŒãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
                        </li>
                        <li><strong>ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ã‚’ç¢ºèª</strong><br>
                            suzuki199534st@gmail.com ã«ãƒ¡ãƒ¼ãƒ«ãŒå±Šã„ã¦ã„ã‚‹ã‹ç¢ºèª<br>
                            â€»å±Šã„ã¦ã„ãªã„å ´åˆã¯è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚©ãƒ«ãƒ€ã‚‚ç¢ºèª
                        </li>
                        <li><strong>Googleãƒ•ã‚©ãƒ¼ãƒ ã®å›ç­”ã‚’ç¢ºèª</strong><br>
                            <a href="https://docs.google.com/forms/d/${GOOGLE_FORM_CONFIG.formId}/edit#responses" target="_blank" style="color: #2196F3;">ãƒ•ã‚©ãƒ¼ãƒ ã®å›ç­”ã‚¿ãƒ–ã‚’é–‹ã</a><br>
                            å›ç­”ãŒ1ä»¶å¢—ãˆã¦ã„ã‚‹ã‹ç¢ºèª
                        </li>
                    </ol>
                    <p style="margin-top: 20px; padding: 10px; background: #fff3cd; border: 1px solid #ffc107; border-radius: 4px;">
                        <strong>âš ï¸ é‡è¦:</strong> no-corsãƒ¢ãƒ¼ãƒ‰ã®ãŸã‚ã€é€ä¿¡ãŒæˆåŠŸã—ãŸã‹ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã‹ã‚’JavaScriptã§åˆ¤å®šã§ãã¾ã›ã‚“ã€‚
                        ä¸Šè¨˜ã®ãƒªãƒ³ã‚¯ã‹ã‚‰å®Ÿéš›ã«ç¢ºèªã—ã¦ãã ã•ã„ã€‚
                    </p>
                `;

                log('ä¸Šè¨˜ã®ãƒªãƒ³ã‚¯ã‹ã‚‰çµæœã‚’ç¢ºèªã—ã¦ãã ã•ã„', 'info');

            } catch (error) {
                log('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message, 'error');
                console.error('Error:', error);

                const resultDiv = document.getElementById('result');
                resultDiv.className = 'error';
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <h3>âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</h3>
                    <p><strong>ã‚¨ãƒ©ãƒ¼å†…å®¹:</strong> ${error.message}</p>
                    <p>ã“ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚</p>
                `;
            } finally {
                btn.disabled = false;
                btn.textContent = 'ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡';
            }
        }
    </script>
</body>
</html>
