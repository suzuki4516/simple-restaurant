# Googleフォーム連携 設定ガイド

予約システムとGoogleフォームを連携させる手順を説明します。

## 手順1: Googleフォームの作成

1. **Googleフォームにアクセス**
   - https://forms.google.com/ にアクセス
   - 「空白」のフォームを新規作成

2. **質問を追加**（以下の順番で作成してください）

   ### 質問1: 予約日時
   - 質問タイプ: **記述式**
   - 質問内容: `予約日時`
   - 必須: オン

   ### 質問2: 予約時間
   - 質問タイプ: **記述式**
   - 質問内容: `予約時間`
   - 必須: オン

   ### 質問3: 人数
   - 質問タイプ: **記述式**
   - 質問内容: `人数`
   - 必須: オン

   ### 質問4: コース
   - 質問タイプ: **記述式**
   - 質問内容: `コース`
   - 必須: オン

   ### 質問5: お名前
   - 質問タイプ: **記述式**
   - 質問内容: `お名前`
   - 必須: オン

   ### 質問6: フリガナ
   - 質問タイプ: **記述式**
   - 質問内容: `フリガナ`
   - 必須: オン

   ### 質問7: メールアドレス
   - 質問タイプ: **記述式**
   - 質問内容: `メールアドレス`
   - 必須: オン
   - データの検証: メールアドレス形式

   ### 質問8: 電話番号
   - 質問タイプ: **記述式**
   - 質問内容: `電話番号`
   - 必須: オン

   ### 質問9: ご要望・アレルギー
   - 質問タイプ: **段落**
   - 質問内容: `ご要望・アレルギー`
   - 必須: オフ

3. **フォーム名を設定**
   - フォーム名: `レストラン味彩 予約フォーム`

## 手順2: フォームURLの取得

1. **フォームを開く**
   - 作成したGoogleフォームの編集画面で、右上の「送信」ボタンをクリック

2. **リンクタブを選択**
   - 「送信」ダイアログで「リンク」タブをクリック
   - 「URLを短縮」のチェックを**外す**（重要！）
   - 表示されたURLをコピー
   - 例: `https://docs.google.com/forms/d/e/1FAIpQLSc...../formResponse`

3. **フォームのIDを確認**
   - URLの中から `/d/e/` と `/formResponse` の間の文字列を探す
   - 例: `1FAIpQLSc_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX`
   - これが**フォームID**です

## 手順3: 各質問のentry IDを取得

これが最も重要なステップです。

1. **フォームのプレビューを開く**
   - Googleフォーム編集画面の右上「プレビュー」ボタン（目のアイコン）をクリック

2. **ブラウザの開発者ツールを開く**
   - Chrome: `F12` または `右クリック > 検証`
   - Edge: `F12`

3. **Elementsタブで各入力欄を調査**
   - 開発者ツールの「Elements」タブを選択
   - 各質問の入力欄を右クリック → 「検証」
   - `<input>` または `<textarea>` タグの `name` 属性を確認
   - `name="entry.XXXXXXXXX"` の数字部分をメモ

4. **各質問のentry IDをメモ**

   例:
   ```
   予約日時: entry.123456789
   予約時間: entry.234567890
   人数: entry.345678901
   コース: entry.456789012
   お名前: entry.567890123
   フリガナ: entry.678901234
   メールアドレス: entry.789012345
   電話番号: entry.890123456
   ご要望・アレルギー: entry.901234567
   ```

## 手順4: コードに設定を反映

`js/reservation.js` ファイルを開き、以下の部分を編集します：

```javascript
// ===== ここを編集 =====
const GOOGLE_FORM_CONFIG = {
    formId: 'ここにフォームIDを貼り付け',
    entries: {
        date: 'entry.123456789',        // 予約日時のentry ID
        time: 'entry.234567890',        // 予約時間のentry ID
        guests: 'entry.345678901',      // 人数のentry ID
        course: 'entry.456789012',      // コースのentry ID
        name: 'entry.567890123',        // お名前のentry ID
        nameKana: 'entry.678901234',    // フリガナのentry ID
        email: 'entry.789012345',       // メールアドレスのentry ID
        phone: 'entry.890123456',       // 電話番号のentry ID
        requests: 'entry.901234567'     // ご要望のentry ID
    }
};
// ===== ここまで =====
```

## 手順5: スプレッドシートでの確認

1. **Googleフォームの「回答」タブ**
   - フォーム編集画面で「回答」タブをクリック
   - 右上の緑色のスプレッドシートアイコンをクリック
   - 「新しいスプレッドシートを作成」を選択

2. **メール通知の設定**
   - スプレッドシートのメニュー: `ツール > 通知ルールを作成`
   - 「フォームが送信されたとき」を選択
   - 「すぐに通知する」を選択
   - メールアドレスを確認して保存

これで、予約が入るたびにメールで通知が届きます！

## トラブルシューティング

### 予約が送信されない場合
1. フォームIDとentry IDが正しいか確認
2. ブラウザのコンソールでエラーを確認（F12 > Console）
3. Googleフォームが「回答を受付中」になっているか確認

### entry IDの取得がうまくいかない場合
- Chromeブラウザを使用してください
- フォームのプレビュー画面で、各入力欄を直接クリックしてから「検証」を選択
- `name="entry.XXXXXXXXX"` という属性を探してください

## テスト方法

1. 予約システムで実際に予約を行う
2. Googleフォームの「回答」タブで予約データが入っているか確認
3. スプレッドシートにデータが記録されているか確認
4. メール通知が届いているか確認

## メール通知のカスタマイズ

Google Apps Script を使うことで、より詳細な通知メールを送ることもできます。
必要な場合はお問い合わせください。
